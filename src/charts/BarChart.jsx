import * as React from 'react';

/**
 * Very simple SVG barchart
 */
const Chart = ({ children, height, width }) => (
	<svg viewBox={`0 0 ${width} ${height}`} height={height} width={width}>
		{children}
	</svg>
)

const Bar = ({ fill, x, y, height, width }) => (
	<rect fill={fill} x={x} y={y} height={height} width={width} />
)

const getColor = (level) => {
	return level === 'critical'
			? 'darkred'
			: level === 'high'
					? 'orangered'
					: level === 'medium'
							? 'yellow'
							: 'green';
}

const greatestValue = (values) => values.reduce((acc, cur) => (cur > acc ? cur : acc));
	
export const BarChart = ({ data }) => {
	const barWidth = 80
	const barMargin = 10
	const width = data.length * (barWidth + barMargin)
	const height = greatestValue(data.map(props => props.total))

	return (
		<Chart height={height} width={width}>
			{data.map((props, index) => (
				<Bar
					key={props.riskLevel}
					fill={getColor(props.riskLevel)}
					x={index * (barWidth + barMargin)}
					y={height - props.total}
					width={barWidth}
					height={props.total}
				/>
			))}
		</Chart>
	)
}

export default BarChart;