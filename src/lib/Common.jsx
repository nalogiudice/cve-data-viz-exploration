/**
 * Common functions/methods
 */

// Risk values based on CVSS v3.0 severity ratings
// https://nvd.nist.gov/vuln-metrics/cvss#
export const
	lowFloor = 1,
	lowCeiling = 39.9999,
	mediumFloor = 40,
	mediumCeiling = 69.9999,
	highFloor = 70,
	highCeiling = 89.9999,
	criticalFloor = 90;

// types are known
export const riskType = ['low', 'medium', 'high', 'critical'];

export const riskCalculator = (comparator) => {
	if (comparator >= lowFloor && comparator < lowCeiling) {
		return 0;
	} else if (comparator > mediumFloor && comparator < mediumCeiling) {
		return 1;
	} else if (comparator > highFloor && comparator < highCeiling) {
		return 2;
	} else if (comparator > criticalFloor) {
		return 3;
	}
};

export const formatTitle = (string) => {
	if (string) {
		return string[0].toUpperCase() + string.slice(1);
	}
};

export const getIdentificationCommonHosts = (hosts) => {
	return hosts.filter((item, index) => index !== hosts.indexOf(item));
};

export const sortByIdentificationType = (key, cveArray) => {
	let array = [];

	cveArray.forEach(item => {
		if (item.identifier.slice(0, 8) === key) {
			array.push(item);
		}
	});

	return array;
};

export const getBarData = (riskMap) => {
	return [
		{
			level: 'low',
			total: riskMap.low.items.length,
			color: 'green',
		},
		{
			level: 'medium',
			total: riskMap.medium.items.length,
			color: 'yellow',
		},
		{
			level: 'high',
			total: riskMap.high.items.length,
			color: 'orangered',
		},
		{
			level: 'critical',
			total: riskMap.critical.items.length,
			color: 'darkred',
		}
	];
};
